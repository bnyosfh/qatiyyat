# .github/workflows/deploy.yml
name: Deploy Vite/React App to GitHub Pages

on:
  push:
    branches: ["main"] # ØªØ´ØºÙŠÙ„ Ø¹Ù†Ø¯ Ø§Ù„Ø±ÙØ¹ Ø¥Ù„Ù‰ Ø§Ù„ÙØ±Ø¹ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
  # ÙŠØ³Ù…Ø­ Ø¨ØªØ´ØºÙŠÙ„ Ø§Ù„Ù€ Action ÙŠØ¯ÙˆÙŠØ§Ù‹ Ù…Ù† ÙˆØ§Ø¬Ù‡Ø© GitHub
  workflow_dispatch: 

# ØªØ¹ÙŠÙŠÙ† Ø¥Ø°Ù† ØµØ±ÙŠØ­ Ù„Ù„ÙƒØªØ§Ø¨Ø© Ù„Ù…ÙƒÙˆÙ†Ø§Øª pages Ùˆ contents
permissions:
  contents: read
  pages: write # Ø§Ù„Ø£Ø°ÙˆÙ†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù„ÙƒØªØ§Ø¨Ø© Ø¥Ù„Ù‰ ØµÙØ­Ø© Ø§Ù„Ù†Ø´Ø±
  id-token: write # Ø§Ù„Ø£Ø°ÙˆÙ†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù„Ù…ØµØ§Ø¯Ù‚Ø©

jobs:
  # 1. Ù…Ù‡Ù…Ø© Ø§Ù„Ø¨Ù†Ø§Ø¡ (Build)
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout ğŸ›ï¸
        uses: actions/checkout@v4

      - name: Setup Node ğŸš€
        uses: actions/setup-node@v4
        with:
          node-version: 20 # ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ù…ØªÙˆØ§ÙÙ‚Ø§Ù‹ Ù…Ø¹ Ù…Ø´Ø±ÙˆØ¹Ùƒ

      - name: Install dependencies and Build ğŸ—ï¸
        run: |
          npm install
          npm run build

      - name: Setup Pages âš™ï¸
        uses: actions/configure-pages@v5
        with:
          static_site_generator: vite # ÙŠØ®Ø¨Ø± GitHub Ø£Ù†Ù†Ø§ Ù†Ø³ØªØ®Ø¯Ù… Vite

      - name: Upload artifact ğŸ“¦
        uses: actions/upload-pages-artifact@v3
        with:
          path: './dist' # Ø±ÙØ¹ Ù…Ø­ØªÙˆÙŠØ§Øª Ù…Ø¬Ù„Ø¯ dist

  # 2. Ù…Ù‡Ù…Ø© Ø§Ù„Ù†Ø´Ø± (Deployment)
  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    needs: build # ÙŠØ¬Ø¨ Ø£Ù† ÙŠØªÙ… Ø§Ù„Ø¨Ù†Ø§Ø¡ Ø£ÙˆÙ„Ø§Ù‹
    steps:
      - name: Deploy to GitHub Pages ğŸš€
        id: deployment
        uses: actions/deploy-pages@v4 # Action Ø§Ù„Ù†Ø´Ø± Ø§Ù„Ø±Ø³Ù…ÙŠ
